import os
import subprocess

# Define the password and the filenames
password = "<Password>"  # Replace with your desired password
certificate_file = "SelfSignedCert.pfx"
malicious_script_file = "MaliciousApp.bat"

# Create a self-signed certificate using certutil
certutil_command = f"certutil -v -p {password} -importPFX {certificate_file}"
subprocess.run(certutil_command, shell=True, check=True)

# Create a malicious executable script
malicious_script_content = 'echo This is a malicious application!\n'
with open(malicious_script_file, 'w') as file:
    file.write(malicious_script_content)

# Sign the malicious executable with the self-signed certificate
signing_command = f'signtool sign /f {certificate_file} /p {password} /tr http://timestamp.digicert.com /td SHA256 {malicious_script_file}'
subprocess.run(signing_command, shell=True, check=True)

# Run the signed malicious executable
subprocess.run(malicious_script_file, shell=True, check=True)
